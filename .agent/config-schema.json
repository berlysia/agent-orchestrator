{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Agent Orchestrator Configuration",
  "description": "Configuration file for Agent Orchestrator (.agent/config.json)",
  "type": "object",
  "properties": {
    "$schema": {
      "type": "string"
    },
    "appRepoPath": {
      "type": "string"
    },
    "agentCoordPath": {
      "type": "string"
    },
    "maxWorkers": {
      "default": 3,
      "type": "integer",
      "exclusiveMinimum": 0,
      "maximum": 9007199254740991
    },
    "agents": {
      "type": "object",
      "properties": {
        "planner": {
          "anyOf": [
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "claude"
                },
                "model": {
                  "anyOf": [
                    {
                      "type": "string",
                      "enum": [
                        "claude-opus-4-5",
                        "claude-sonnet-4-5",
                        "claude-haiku-4-5"
                      ]
                    },
                    {
                      "type": "string"
                    }
                  ]
                }
              },
              "required": [
                "type",
                "model"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "codex"
                },
                "model": {
                  "anyOf": [
                    {
                      "type": "string",
                      "enum": [
                        "gpt-5.2-codex",
                        "gpt-5.1-codex-mini"
                      ]
                    },
                    {
                      "type": "string"
                    }
                  ]
                }
              },
              "required": [
                "type",
                "model"
              ],
              "additionalProperties": false
            }
          ]
        },
        "worker": {
          "anyOf": [
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "claude"
                },
                "model": {
                  "anyOf": [
                    {
                      "type": "string",
                      "enum": [
                        "claude-opus-4-5",
                        "claude-sonnet-4-5",
                        "claude-haiku-4-5"
                      ]
                    },
                    {
                      "type": "string"
                    }
                  ]
                }
              },
              "required": [
                "type",
                "model"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "codex"
                },
                "model": {
                  "anyOf": [
                    {
                      "type": "string",
                      "enum": [
                        "gpt-5.2-codex",
                        "gpt-5.1-codex-mini"
                      ]
                    },
                    {
                      "type": "string"
                    }
                  ]
                }
              },
              "required": [
                "type",
                "model"
              ],
              "additionalProperties": false
            }
          ]
        },
        "judge": {
          "anyOf": [
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "claude"
                },
                "model": {
                  "anyOf": [
                    {
                      "type": "string",
                      "enum": [
                        "claude-opus-4-5",
                        "claude-sonnet-4-5",
                        "claude-haiku-4-5"
                      ]
                    },
                    {
                      "type": "string"
                    }
                  ]
                }
              },
              "required": [
                "type",
                "model"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "codex"
                },
                "model": {
                  "anyOf": [
                    {
                      "type": "string",
                      "enum": [
                        "gpt-5.2-codex",
                        "gpt-5.1-codex-mini"
                      ]
                    },
                    {
                      "type": "string"
                    }
                  ]
                }
              },
              "required": [
                "type",
                "model"
              ],
              "additionalProperties": false
            }
          ]
        }
      },
      "required": [
        "planner",
        "worker",
        "judge"
      ],
      "additionalProperties": false
    },
    "checks": {
      "default": {
        "enabled": true,
        "failureMode": "block"
      },
      "type": "object",
      "properties": {
        "enabled": {
          "default": true,
          "type": "boolean"
        },
        "failureMode": {
          "default": "block",
          "type": "string",
          "enum": [
            "block",
            "warn"
          ]
        }
      },
      "required": [
        "enabled",
        "failureMode"
      ],
      "additionalProperties": false
    },
    "commit": {
      "default": {
        "autoSignature": false,
        "integrationSignature": true
      },
      "type": "object",
      "properties": {
        "autoSignature": {
          "default": false,
          "type": "boolean"
        },
        "integrationSignature": {
          "default": true,
          "type": "boolean"
        }
      },
      "required": [
        "autoSignature",
        "integrationSignature"
      ],
      "additionalProperties": false
    },
    "integration": {
      "default": {
        "method": "auto",
        "postIntegrationEvaluation": true,
        "maxAdditionalTaskIterations": 3,
        "mergeStrategy": "ff-prefer"
      },
      "type": "object",
      "properties": {
        "method": {
          "default": "auto",
          "type": "string",
          "enum": [
            "pr",
            "command",
            "auto"
          ]
        },
        "postIntegrationEvaluation": {
          "default": true,
          "type": "boolean"
        },
        "maxAdditionalTaskIterations": {
          "default": 3,
          "type": "integer",
          "minimum": 1,
          "maximum": 10
        },
        "mergeStrategy": {
          "default": "ff-prefer",
          "type": "string",
          "enum": [
            "ff-prefer",
            "no-ff"
          ]
        }
      },
      "required": [
        "method",
        "postIntegrationEvaluation",
        "maxAdditionalTaskIterations",
        "mergeStrategy"
      ],
      "additionalProperties": false
    },
    "planning": {
      "default": {
        "qualityThreshold": 60,
        "strictContextValidation": false,
        "maxTaskDuration": 4,
        "maxTasks": 5
      },
      "type": "object",
      "properties": {
        "qualityThreshold": {
          "default": 60,
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "strictContextValidation": {
          "default": false,
          "type": "boolean"
        },
        "maxTaskDuration": {
          "default": 4,
          "type": "number",
          "minimum": 0.5,
          "maximum": 8
        },
        "maxTasks": {
          "default": 5,
          "type": "integer",
          "minimum": 1,
          "maximum": 20
        },
        "planQualityJudge": {
          "anyOf": [
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "claude"
                },
                "model": {
                  "anyOf": [
                    {
                      "type": "string",
                      "enum": [
                        "claude-opus-4-5",
                        "claude-sonnet-4-5",
                        "claude-haiku-4-5"
                      ]
                    },
                    {
                      "type": "string"
                    }
                  ]
                }
              },
              "required": [
                "type",
                "model"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "codex"
                },
                "model": {
                  "anyOf": [
                    {
                      "type": "string",
                      "enum": [
                        "gpt-5.2-codex",
                        "gpt-5.1-codex-mini"
                      ]
                    },
                    {
                      "type": "string"
                    }
                  ]
                }
              },
              "required": [
                "type",
                "model"
              ],
              "additionalProperties": false
            }
          ]
        }
      },
      "required": [
        "qualityThreshold",
        "strictContextValidation",
        "maxTaskDuration",
        "maxTasks"
      ],
      "additionalProperties": false
    },
    "iterations": {
      "default": {
        "plannerQualityRetries": 5,
        "judgeTaskRetries": 3,
        "orchestrateMainLoop": 3,
        "serialChainTaskRetries": 3
      },
      "type": "object",
      "properties": {
        "plannerQualityRetries": {
          "default": 5,
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        },
        "judgeTaskRetries": {
          "default": 3,
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        },
        "orchestrateMainLoop": {
          "default": 3,
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        },
        "serialChainTaskRetries": {
          "default": 3,
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        }
      },
      "required": [
        "plannerQualityRetries",
        "judgeTaskRetries",
        "orchestrateMainLoop",
        "serialChainTaskRetries"
      ],
      "additionalProperties": false
    },
    "replanning": {
      "default": {
        "enabled": true,
        "maxIterations": 3,
        "timeoutSeconds": 300
      },
      "type": "object",
      "properties": {
        "enabled": {
          "default": true,
          "type": "boolean"
        },
        "maxIterations": {
          "default": 3,
          "type": "integer",
          "minimum": 1,
          "maximum": 10
        },
        "timeoutSeconds": {
          "default": 300,
          "type": "integer",
          "minimum": 60,
          "maximum": 600
        }
      },
      "required": [
        "enabled",
        "maxIterations",
        "timeoutSeconds"
      ],
      "additionalProperties": false
    },
    "refinement": {
      "default": {
        "maxRefinementAttempts": 2,
        "refineSuggestionsOnSuccess": false,
        "maxSuggestionReplans": 1,
        "enableIndividualFallback": true,
        "deltaThreshold": 5,
        "deltaThresholdPercent": 5,
        "taskCountChangeThreshold": 0.3,
        "taskCountChangeMinAbsolute": 2
      },
      "type": "object",
      "properties": {
        "maxRefinementAttempts": {
          "default": 2,
          "type": "integer",
          "minimum": 1,
          "maximum": 10
        },
        "refineSuggestionsOnSuccess": {
          "default": false,
          "type": "boolean"
        },
        "maxSuggestionReplans": {
          "default": 1,
          "type": "integer",
          "minimum": 0,
          "maximum": 5
        },
        "enableIndividualFallback": {
          "default": true,
          "type": "boolean"
        },
        "deltaThreshold": {
          "default": 5,
          "type": "number",
          "minimum": 0
        },
        "deltaThresholdPercent": {
          "default": 5,
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "taskCountChangeThreshold": {
          "default": 0.3,
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "taskCountChangeMinAbsolute": {
          "default": 2,
          "type": "integer",
          "minimum": 1,
          "maximum": 9007199254740991
        }
      },
      "required": [
        "maxRefinementAttempts",
        "refineSuggestionsOnSuccess",
        "maxSuggestionReplans",
        "enableIndividualFallback",
        "deltaThreshold",
        "deltaThresholdPercent",
        "taskCountChangeThreshold",
        "taskCountChangeMinAbsolute"
      ],
      "additionalProperties": false
    },
    "worktree": {
      "default": {
        "postCreate": []
      },
      "type": "object",
      "properties": {
        "postCreate": {
          "default": [],
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "postCreate"
      ],
      "additionalProperties": false
    },
    "github": {
      "type": "object",
      "properties": {
        "apiBaseUrl": {
          "default": "https://api.github.com",
          "type": "string"
        },
        "owner": {
          "type": "string"
        },
        "repo": {
          "type": "string"
        },
        "auth": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "pat"
            },
            "tokenEnvName": {
              "type": "string"
            }
          },
          "required": [
            "type",
            "tokenEnvName"
          ],
          "additionalProperties": false
        }
      },
      "required": [
        "apiBaseUrl",
        "owner",
        "repo",
        "auth"
      ],
      "additionalProperties": false
    }
  },
  "required": [
    "appRepoPath",
    "agentCoordPath",
    "maxWorkers",
    "agents",
    "checks",
    "commit",
    "integration",
    "planning",
    "iterations",
    "replanning",
    "refinement",
    "worktree"
  ],
  "additionalProperties": false
}
